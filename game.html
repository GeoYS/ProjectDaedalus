<div id="main" style="overflow: hidden">
		<div id="map" style="position: absolute;">	
		</div>
		<p id="mapDimensions"></p>
</div>
<script type="text/javascript">
	initGameViewModel();
	
	$(document).on('click', '.tile', function() {
		var coord = $(this).attr('id');
		var dialogDiv = $('#dialog');
		dialogDiv.load('area.html', function() {			
			var areaDiv = dialogDiv.find('.area');
			initAreaViewModel(areaDiv, gameViewModel.tileMap[coord], coord);
		
			dialogDiv.dialog({
				title: coord,
				close: function() {
					cleanUp(areaDiv);
					dialogDiv.empty();
				}
			});
		});
	});
	
	// Dragging of map using middle mouse button
	var lastX, lastY;
	var isDragging = false;
	
	$(document)
	.mousedown(function(event) {
		if(event.which == 2) {
			lastX = event.pageX;
			lastY = event.pageY;
			isDragging = true;
		}
	})
	.mousemove(function(event) {
		if(event.which == 2) {
			if(isDragging) {
				var map = $('#map')
				var oldOffset = map.offset();
				var newOffsetX = oldOffset['left'] + event.pageX - lastX;
				var newOffsetY = oldOffset['top'] + event.pageY - lastY;
				
				if(newOffsetX > 300) {
					newOffsetX = 300;
				}
				if(newOffsetX < -3300 + $(window).width()) {
					newOffsetX = -3300  + $(window).width();
				}
				
				if(newOffsetY > 300) {
					newOffsetY = 300;
				}
				if(newOffsetY < -3300 + $(window).height()) {
					newOffsetY = -3300 + $(window).height();
				}
				
				map.offset({
					top: newOffsetY,
					left: newOffsetX
				});
				
				lastX = event.pageX;			
				lastY = event.pageY;
				
				isDragging = true;
			}
		}
	})
	.mouseup(function(event) {
		if(event.which == 2) {
			isDragging = false;
		}
	});
</script>